{"version":3,"file":"index.js","sources":["../js/infiniteScroll.js","../js/index.js","../js/accentBar.js"],"sourcesContent":["/*\nThis script continously loads post as the user scrolls the page. It uses the IntersectionObserver API to detect when the last post is in view. When the last post is in view, it fetches the next page and appends the posts to the page. It then checks if there is a next page and if there is, it continues to observe the last post. If there is no next page, it disconnects the observer. \n\nImportantly, for this script to work, it requires that each card have the `post` class and that the card container have the `gh-postfeed` class\n*/\n\nlet link = document.querySelector('link[rel=\"next\"]')?.getAttribute('href');\n\n// Fetch and parse next page\nasync function getNextPage(url) {\n    try {\n        const res = await fetch(url);\n        \n        if (!res.ok) {\n            throw new Error('Failed to fetch page')\n        }\n        \n        const nextPageHtml = await res.text();\n        const parser = new DOMParser();\n        const parsed = parser.parseFromString(nextPageHtml, 'text/html');\n        const posts = parsed.querySelectorAll('.post');\n        const nextLink = parsed.querySelector('link[rel=\"next\"]')?.getAttribute('href');\n        \n        return {posts, nextLink}\n\n    } catch (error) {\n        throw new Error(error)\n    }\n}\n\nexport default function infiniteScroll() {\n    \n    if (!link) { return; }\n\n    const options = {\n        // When the last card is within a 150px of the viewport, fetch the next page. This provides a smoother transition between pages \n       rootMargin: '150px',\n    }\n\n    const callback = (entries, observer) => {\n        try {\n            entries.forEach(entry => {\n            \n                if (entry.isIntersecting) {\n                    \n                    if (link) {\n                        getNextPage(link).then(({posts, nextLink}) => {\n                            posts.forEach(post => {\n                                document.querySelector('.gh-postfeed').append(post)\n                            })\n\n                            if (nextLink) {\n                                link = nextLink;\n                                observer.observe(document.querySelector('.post:last-of-type'))\n                            } else {\n                                observer.disconnect()\n                            }\n                        })\n                    }\n                }\n            })\n        } catch (error) {\n            console.log(error)\n        }\n    }\n\n    let observer = new IntersectionObserver(callback, options);\n\n    observer.observe(document.querySelector('.post:last-of-type'))\n\n}","// JavaScript files are compiled and minified during the build process to the assets/built folder. See available scripts in the package.json file.\n\n// Import CSS\nimport \"../css/index.css\";\n\n// Import JS\nimport infiniteScroll from \"./infiniteScroll\";\nimport initAccentBar from \"./accentBar\";\n\n// Initialize features\ninfiniteScroll();\ninitAccentBar();","/**\n * Accent Bar Behavior\n * - Makes the orange accent bar sticky when scrolling\n * - Highlights section headings (h2) when they align with the bar position\n */\n\nexport default function initAccentBar() {\n  const bar = document.querySelector('.accent-bar');\n  if (!bar) return;\n\n  // Make the bar sticky\n  bar.classList.add('sticky');\n  bar.style.top = '2rem';\n\n  // Find all h2 headings in the main content (not in posts with prose styling)\n  const article = document.querySelector('article');\n  if (!article) return;\n\n  // Only apply highlighting on pages (not posts)\n  // Posts use prose styling and don't need this feature\n  if (document.body.classList.contains('post-template')) return;\n\n  const headings = article.querySelectorAll('h2');\n  if (!headings.length) return;\n\n  // Track the currently highlighted heading\n  let currentHighlight = null;\n\n  // Create an IntersectionObserver to detect when headings are near the top\n  const observer = new IntersectionObserver(\n    (entries) => {\n      entries.forEach((entry) => {\n        if (entry.isIntersecting) {\n          // Remove highlight from previous heading\n          if (currentHighlight && currentHighlight !== entry.target) {\n            currentHighlight.classList.remove('text-accent-500');\n          }\n          // Add highlight to current heading\n          entry.target.classList.add('text-accent-500');\n          currentHighlight = entry.target;\n        }\n      });\n    },\n    {\n      // Trigger when heading is in the top portion of the viewport\n      // This creates a \"zone\" where the accent bar would align with headings\n      rootMargin: '-4rem 0px -85% 0px',\n      threshold: 0\n    }\n  );\n\n  // Observe all headings\n  headings.forEach((heading) => {\n    // Add transition for smooth color change\n    heading.classList.add('transition-colors', 'duration-300');\n    observer.observe(heading);\n  });\n\n  // Clean up when navigating away (for SPAs)\n  return () => {\n    observer.disconnect();\n  };\n}\n"],"names":["link","document","querySelector","getAttribute","IntersectionObserver","callback","entries","observer","forEach","entry","isIntersecting","async","url","res","fetch","ok","Error","nextPageHtml","text","parsed","DOMParser","parseFromString","posts","querySelectorAll","nextLink","error","getNextPage","then","post","append","observe","disconnect","console","log","rootMargin","infiniteScroll","bar","classList","add","style","top","article","body","contains","headings","length","currentHighlight","target","remove","threshold","heading","initAccentBar"],"mappings":"yBAMA,IAAIA,EAAOC,SAASC,cAAc,qBAAqBC,aAAa,SAwBrD,WAEX,IAAKH,EAAQ,OAkCE,IAAII,qBA3BFC,CAACC,EAASC,KACvB,IACID,EAAQE,QAAQC,IAERA,EAAMC,gBAEFV,GApCxBW,eAA2BC,GACvB,IACI,MAAMC,QAAYC,MAAMF,GAExB,IAAKC,EAAIE,GACL,MAAM,IAAIC,MAAM,wBAGpB,MAAMC,QAAqBJ,EAAIK,OAEzBC,GADS,IAAIC,WACGC,gBAAgBJ,EAAc,aAC9CK,EAAQH,EAAOI,iBAAiB,SAChCC,EAAWL,EAAOjB,cAAc,qBAAqBC,aAAa,QAExE,MAAO,CAACmB,QAAOE,WAElB,CAAC,MAAOC,GACL,MAAM,IAAIT,MAAMS,EACpB,CACJ,CAkBwBC,CAAY1B,GAAM2B,KAAK,EAAEL,QAAOE,eAC5BF,EAAMd,QAAQoB,IACV3B,SAASC,cAAc,gBAAgB2B,OAAOD,KAG9CJ,GACAxB,EAAOwB,EACPjB,EAASuB,QAAQ7B,SAASC,cAAc,wBAExCK,EAASwB,gBAMhC,CAAC,MAAON,GACLO,QAAQC,IAAIR,EAChB,GA7BY,CAEbS,WAAY,UAgCNJ,QAAQ7B,SAASC,cAAc,sBAE5C,CC5DAiC,GCJe,WACb,MAAMC,EAAMnC,SAASC,cAAc,eACnC,IAAKkC,EAAK,OAGVA,EAAIC,UAAUC,IAAI,UAClBF,EAAIG,MAAMC,IAAM,OAGhB,MAAMC,EAAUxC,SAASC,cAAc,WACvC,IAAKuC,EAAS,OAId,GAAIxC,SAASyC,KAAKL,UAAUM,SAAS,iBAAkB,OAEvD,MAAMC,EAAWH,EAAQlB,iBAAiB,MAC1C,IAAKqB,EAASC,OAAQ,OAGtB,IAAIC,EAAmB,KAGvB,MAAMvC,EAAW,IAAIH,qBAClBE,IACCA,EAAQE,QAASC,IACXA,EAAMC,iBAEJoC,GAAoBA,IAAqBrC,EAAMsC,QACjDD,EAAiBT,UAAUW,OAAO,mBAGpCvC,EAAMsC,OAAOV,UAAUC,IAAI,mBAC3BQ,EAAmBrC,EAAMsC,WAI/B,CAGEb,WAAY,qBACZe,UAAW,IAKfL,EAASpC,QAAS0C,IAEhBA,EAAQb,UAAUC,IAAI,oBAAqB,gBAC3C/B,EAASuB,QAAQoB,IAOrB,CDnDAC"}